{% extends "base.html" %}
{% load custom_i18n %}

{% block title %}{{ summary.title }} - TA{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Back Button and Print -->
    <div class="mb-6 flex items-center justify-between no-print">
        <a href="{% url 'articles:weekly_summaries' %}" 
           class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium font-display text-gray-700 bg-white hover:bg-gray-50 border border-gray-200 rounded-md transition-colors duration-200">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
            {{ "Back to Summaries"|translate:current_language }}
        </a>
        <div class="flex gap-2">
            <button onclick="window.print()" class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium font-display text-gray-700 bg-white hover:bg-gray-50 border border-gray-200 rounded-md transition-colors duration-200">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                </svg>
                {{ "Print"|translate:current_language }}
            </button>
            <a href="{% url 'articles:weekly_summary_pdf' summary.id %}" class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium font-display text-white bg-primary hover:bg-primary/90 rounded-md transition-colors duration-200">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                {{ "Download PDF"|translate:current_language }}
            </a>
        </div>
    </div>

    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold font-display text-gray-900 mb-4">{{ summary.title }}</h1>
        
        <!-- Metadata -->
        <div class="flex flex-wrap gap-6 text-xs text-gray-600">
            <div class="flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span>{{ "Generated"|translate:current_language }}: {{ summary.generated_at|date:"d F Y, H:i" }}</span>
            </div>
            <div class="flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <span>{{ summary.articles_analyzed }} {{ "articles analyzed"|translate:current_language }}</span>
            </div>
            <div class="flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>{{ "Period"|translate:current_language }}: {{ summary.period_start|date:"d M" }} - {{ summary.period_end|date:"d M Y" }}</span>
            </div>
        </div>
    </div>

    <!-- Executive Summary -->
    <div class="bg-gradient-to-r from-primary/5 to-secondary/10 border border-primary/20 rounded-lg p-6 mb-8">
        <h2 class="flex items-center gap-2 text-lg font-semibold font-display text-primary mb-4">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
            </svg>
            {{ "Executive Summary"|translate:current_language }}
        </h2>
        <p class="text-sm text-gray-800 leading-relaxed">{{ summary.executive_summary }}</p>
    </div>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
        <!-- Main Trends -->
        {% if summary.main_trends %}
        <div class="lg:col-span-2">
            <div class="bg-white rounded-lg shadow-sm border border-secondary p-6">
                <h2 class="flex items-center gap-2 text-lg font-semibold font-display text-gray-700 mb-4">
                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                    </svg>
                    {{ "Main Trends"|translate:current_language }}
                </h2>
                <div class="space-y-3">
                    {% for trend in summary.main_trends %}
                    <div class="flex items-start gap-3">
                        <span class="flex-shrink-0 inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-600 text-xs font-medium">{{ forloop.counter }}</span>
                        <p class="text-sm text-gray-700 leading-relaxed">{{ trend }}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Featured Sectors -->
        {% if summary.featured_sectors %}
        <div>
            <div class="bg-white rounded-lg shadow-sm border border-secondary p-6">
                <h2 class="flex items-center gap-2 text-lg font-semibold font-display text-gray-700 mb-4">
                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    {{ "Featured Sectors"|translate:current_language }}
                </h2>
                <div class="space-y-2">
                    {% for sector in summary.featured_sectors %}
                    <div class="text-sm text-gray-700 py-1.5 border-b border-gray-100 last:border-0">
                        {{ sector }}
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Opportunities for Italy -->
    {% if summary.opportunities_italy %}
    <div class="bg-gradient-to-r from-green-50 to-yellow-50 border border-green-200 rounded-lg p-6 mb-8">
        <h2 class="flex items-center gap-2 text-lg font-semibold font-display text-green-700 mb-4">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
            </svg>
            {{ "Opportunities for Italian Companies"|translate:current_language }}
        </h2>
        <p class="text-sm text-gray-800 leading-relaxed">{{ summary.opportunities_italy }}</p>
    </div>
    {% endif %}

    <!-- Full Content -->
    <div class="bg-white rounded-lg shadow-sm border border-secondary p-8 mb-8">
        <h2 class="flex items-center gap-2 text-lg font-semibold font-display text-gray-700 mb-6">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            {{ "Complete Analysis"|translate:current_language }}
        </h2>
        <div class="prose max-w-none">
            <div class="text-sm text-gray-700 leading-relaxed whitespace-pre-line font-light">{{ summary.full_content }}</div>
        </div>
    </div>

    <!-- Footer Actions -->
    <div class="flex justify-between items-center pt-6 border-t border-gray-100 no-print">
        <div class="text-xs text-gray-500">
            {{ "Generated by"|translate:current_language }} {{ summary.llm_model|default:"AI Assistant" }}
        </div>
        <a href="{% url 'articles:weekly_summaries' %}" 
           class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium font-display text-white bg-primary hover:bg-primary/90 rounded-md transition-colors duration-200">
            {{ "View All Summaries"|translate:current_language }}
        </a>
    </div>
</div>
{% endblock %}
