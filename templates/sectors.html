{% extends "base.html" %}

{% block title %}Settori Â· TA{% endblock %}

{% block content %}
<div class="container mx-auto max-w-6xl">
  <header class="mb-8">
    <div class="flex items-center justify-between">
      <h1 class="text-4xl font-bold">Settori</h1>
      <a href="/" class="btn btn-outline">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Torna alla Home
      </a>
    </div>
    <p class="text-base-content/70 mt-2">Esplora gli articoli per settore industriale</p>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    {% for sector_info in sectors %}
      <div class="card bg-base-100 shadow-md border hover:shadow-lg transition-shadow">
        <div class="card-body">
          <h2 class="card-title text-lg">
            <a href="{% url 'articles:sector_detail' sector_info.name %}" class="no-underline hover:text-primary">
              {{ sector_info.name }}
            </a>
          </h2>
          
          <div class="flex items-center justify-between mt-4">
            <div class="badge badge-primary">
              {{ sector_info.count }} articol{{ sector_info.count|pluralize:"o,i" }}
            </div>
            
            {% if sector_info.count > 0 %}
              <a href="{% url 'articles:sector_detail' sector_info.name %}" class="btn btn-sm btn-outline">
                Visualizza
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </a>
            {% else %}
              <span class="text-sm text-base-content/50">Nessun articolo</span>
            {% endif %}
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-span-full text-center py-12">
        <p class="text-base-content/70">Nessun settore disponibile.</p>
      </div>
    {% endfor %}
  </div>

  <!-- Summary Stats -->
  <div class="mt-12 stats shadow w-full">
    <div class="stat">
      <div class="stat-title">Settori Totali</div>
      <div class="stat-value">{{ sectors|length }}</div>
      <div class="stat-desc">Categorie industriali</div>
    </div>
    
    <div class="stat">
      <div class="stat-title">Settori con Articoli</div>
      <div class="stat-value">
        {% with sectors_with_articles=sectors|length %}
          {% for sector_info in sectors %}
            {% if sector_info.count > 0 %}
              {% if forloop.first %}1{% else %}{{ forloop.counter }}{% endif %}
            {% endif %}
          {% endfor %}
        {% endwith %}
      </div>
      <div class="stat-desc">Hanno contenuti disponibili</div>
    </div>
    
    <div class="stat">
      <div class="stat-title">Articoli Totali</div>
      <div class="stat-value">
        {% with total_articles=0 %}
          {% for sector_info in sectors %}
            {% with total_articles=total_articles|add:sector_info.count %}
              {% if forloop.last %}{{ total_articles }}{% endif %}
            {% endwith %}
          {% endfor %}
        {% endwith %}
      </div>
      <div class="stat-desc">Tradotti in italiano</div>
    </div>
  </div>
</div>
{% endblock %}
