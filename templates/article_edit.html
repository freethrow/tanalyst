{% extends "base.html" %}
{% load i18n %}

{% block title %}{{ page_title }} Â· TA{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
  <header class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold font-display text-gray-700">{% trans "Edit Article" %}</h1>
        <p class="text-sm text-gray-600 mt-1">{% trans "Update article content and translation" %}</p>
      </div>
      <div class="flex gap-3">
        <a href="{% url 'articles:article_detail' article.pk %}" class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium font-display text-gray-700 bg-white hover:bg-gray-50 border border-gray-200 rounded-md transition-colors duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
          {% trans "View Article" %}
        </a>
        <a href="/" class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium font-display text-gray-700 bg-white hover:bg-gray-50 border border-gray-200 rounded-md transition-colors duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          {% trans "Back to List" %}
        </a>
      </div>
  </header>

  <!-- Messages are handled in base.html -->

  <form method="post" class="space-y-6">
    {% csrf_token %}
    
    <!-- Article Translation Editor -->
    <div class="bg-white rounded-lg shadow-sm border border-secondary mb-6">
      <div class="p-6">
        <h2 class="text-xl font-semibold font-display text-gray-700 mb-6">{% trans "Translation Editor" %}</h2>
        <!-- Titles Side by Side -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6">
          <!-- Original Title -->
          {% if source_language %}
            <div>
              <label class="block text-sm font-medium font-display text-gray-700 mb-2">
                {% blocktrans %}{{ source_language }} Title{% endblocktrans %}
              </label>
              <div class="w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-gray-600 cursor-not-allowed">
                {{ source_title|default:"No title available" }}
              </div>
            </div>
          {% endif %}
          
          <!-- Italian Title -->
          <div>
            <label class="block text-sm font-medium font-display text-gray-700 mb-2" for="{{ form.title_it.id_for_label }}">
              {% trans "Italian Title" %}
            </label>
            {{ form.title_it }}
            {% if form.title_it.errors %}
              <p class="mt-1 text-sm text-red-600">{{ form.title_it.errors.0 }}</p>
            {% endif %}
          </div>
        </div>

        <!-- Content Side by Side -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
          <!-- Original Content -->
          {% if source_language %}
            <div class="lg:col-span-2">
              <label class="block text-sm font-medium font-display text-gray-700 mb-2">
                {% blocktrans %}{{ source_language }} Content{% endblocktrans %}
              </label>
              <div class="w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-gray-600 cursor-not-allowed min-h-[400px] overflow-y-auto whitespace-pre-wrap">{{ source_content|default:"No content available"|safe }}</div>
            </div>
          {% endif %}
          
          <!-- Italian Content -->
          <div class="lg:col-span-2">
            <label class="block text-sm font-medium font-display text-gray-700 mb-2" for="{{ form.content_it.id_for_label }}">
              {% trans "Italian Content" %}
            </label>
            {{ form.content_it }}
            {% if form.content_it.errors %}
              <p class="mt-1 text-sm text-red-600">{{ form.content_it.errors.0 }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Status Flags -->
    <div class="bg-white rounded-lg shadow-sm border border-secondary mb-6">
      <div class="p-6">
        <h2 class="text-xl font-semibold font-display text-gray-700 mb-6">{% trans "Article Status" %}</h2>
        <div>
          <label class="block text-sm font-medium font-display text-gray-700 mb-2">
            {% trans "Status" %}
          </label>
          {{ form.status }}
          {% if form.status.errors %}
            <p class="mt-1 text-sm text-red-600">{{ form.status.errors.0 }}</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="flex justify-end gap-3 pt-6 border-t border-gray-100">
      <a href="{% url 'articles:article_detail' article.pk %}" class="inline-flex items-center gap-2 px-6 py-2.5 text-sm font-medium font-display text-gray-700 bg-white hover:bg-gray-50 border border-gray-200 rounded-md transition-colors duration-200">
        {% trans "Cancel" %}
      </a>
      <button type="submit" class="inline-flex items-center gap-2 px-6 py-2.5 text-sm font-medium font-display text-white bg-primary hover:bg-primary/90 rounded-md transition-colors duration-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
        {% trans "Save Changes" %}
      </button>
    </div>
  </form>
</div>

<style>
/* Custom styles for form fields */
input[type="text"],
input[type="url"],
input[type="datetime-local"],
textarea,
select {
  @apply w-full px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-colors;
}

textarea {
  @apply min-h-[400px] resize-y text-sm font-light;
}

select {
  @apply cursor-pointer bg-white;
}

input[type="checkbox"] {
  @apply w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary cursor-pointer;
}
</style>
{% endblock %}
